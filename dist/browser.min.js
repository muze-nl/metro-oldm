(()=>{function o(i){return new c(i)}var y="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",m={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",solid:"http://www.w3.org/ns/solid/terms#",schema:"http://schema.org/",vcard:"http://www.w3.org/2006/vcard/ns#"},c=class{constructor(t){this.prefixes={...m,...t?.prefixes},this.prefixes.xsd||(this.prefixes.xsd="http://www.w3.org/2001/XMLSchema#"),this.parser=t?.parser,this.writer=t?.writer,this.sources=Object.create(null),this.separator=t?.separator??"$"}parse(t,e,s){let{quads:n,prefixes:a}=this.parser(t,e,s);if(a)for(let r in a){let h=a[r];if(h.match(/^http(s?):\/\/$/i))h+=e.substring(h.length);else try{h=new URL(a[r],e).href}catch(d){console.error("Could not parse prefix",a[r],d.message)}this.prefixes[r]||(this.prefixes[r]=h)}return this.sources[e]=new u(n,e,s,a,this),this.sources[e]}setType(t,e){if(!e)return t;if(typeof t=="string"?t=new String(t):typeof result=="number"&&(t=new Number(t)),typeof t!="object")throw new Error("cannot set type on ",t,e);return t.type=e,t}getType(t){return t&&typeof t=="object"?t.type:null}},u=class{#t=Object.create(null);constructor(t,e,s,n,a){this.mimetype=s,this.url=e,this.prefixes=n,this.context=a,this.subjects=Object.create(null);for(let r of t){let h;if(r.subject.termType=="BlankNode"){let d=this.shortURI(r.predicate.id,":"),g;switch(d){case"rdf:first":if(h=this.addCollection(r.subject.id),g=this.shortURI(r.object.id,":"),g!="rdf:nil"){let x=this.getValue(r.object);x&&h.push(x)}continue;case"rdf:rest":this.#t[r.object.id]=this.#t[r.subject.id];continue;default:h=this.addBlankNode(r.subject.id);break}}else h=this.addNamedNode(r.subject.id);h.addPredicate(r.predicate.id,r.object)}this.subjects[e]?this.primary=this.subjects[e]:this.primary=null,Object.defineProperty(this,"data",{get(){return Object.values(this.subjects)}})}addNamedNode(t){let e=new URL(t,this.url).href;return this.subjects[e]||(this.subjects[e]=new w(e,this)),this.subjects[e]}addBlankNode(t){return this.#t[t]||(this.#t[t]=new f(this)),this.#t[t]}addCollection(t){return this.#t[t]||(this.#t[t]=new l(this)),this.#t[t]}write(){return this.context.writer(this)}get(t){return this.subjects[this.fullURI(t)]}fullURI(t,e=null){e||(e=this.context.separator);let[s,n]=t.split(e);return n?this.prefixes[s]+n:t}shortURI(t,e=null){e||(e=this.context.separator);for(let s in this.context.prefixes)if(t.startsWith(this.context.prefixes[s]))return s+e+t.substring(this.context.prefixes[s].length);return this.url&&t.startsWith(this.url)?t.substring(this.url.length):t}setType(t,e){let s=this.shortURI(e);return this.context.setType(t,s)}getType(t){return this.context.getType(t)}setLanguage(t,e){if(typeof t=="string"?t=new String(t):typeof result=="number"&&(t=new Number(t)),typeof t!="object")throw new Error("cannot set language on ",t);return t.language=e,t}getValue(t){let e;if(t.termType=="Literal"){e=t.value;let s=t.datatype?.id;s&&(e=this.setType(e,s));let n=t.language;n&&(e=this.setLanguage(e,n))}else t.termType=="BlankNode"?e=this.addBlankNode(t.id):e=this.addNamedNode(t.id);return e}},f=class{constructor(t){Object.defineProperty(this,"graph",{value:t,writable:!1,enumerable:!1})}addPredicate(t,e){if(t.id&&(t=t.id),t==y){let s=this.graph.shortURI(e.id);this.addType(s)}else{let s=this.graph.getValue(e);t=this.graph.shortURI(t),this[t]?Array.isArray(this[t])?this[t].push(s):this[t]=[this[t],s]:this[t]=s}}addType(t){this.a?(Array.isArray(this.a)||(this.a=[this.a]),this.a.push(t)):this.a=t}},w=class extends f{constructor(t,e){super(e),Object.defineProperty(this,"id",{value:t,writable:!1,enumerable:!0})}},l=class extends Array{constructor(t,e){super(),Object.defineProperty(this,"graph",{value:e,writable:!1,enumerable:!1})}};function p(i){i=Object.assign({contentType:"text/turtle",prefixes:{ldp:"http://www.w3.org/ns/ldp#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",dct:"http://purl.org/dc/terms/",stat:"http://www.w3.org/ns/posix/stat#",turtle:"http://www.w3.org/ns/iana/media-types/text/turtle#",schem:"https://schema.org/",solid:"http://www.w3.org/ns/solid/terms#",acl:"http://www.w3.org/ns/auth/acl#",pims:"http://www.w3.org/ns/pim/space#",vcard:"http://www.w3.org/2006/vcard/ns#",foaf:"http://xmlns.com/foaf/0.1/"},parser:o.n3Parser,writer:o.n3Writer},i),i.prefixes.ldp||(i.prefixes.ldp="http://www.w3.org/ns/ldp#");let t=o(i);return async function(s,n){if(s.headers.get("Accept")||(s=s.with({headers:{Accept:i.accept??i.contentType}})),s.method!=="GET"&&s.method!=="HEAD"&&s.data&&typeof s.data=="object"&&!(s.data instanceof ReadableStream)){let r=s.headers.get("Content-Type");(!r||isPlainText(r))&&(s=s.with({headers:{"Content-Type":i.contentType}})),isLinkedData(s.headers.get("Content-Type"))&&(s=s.with({body:await t.writer(s.data)}))}let a=await n(s)}}globalThis.oldmmw=p;var N=p;})();
//# sourceMappingURL=browser.min.js.map
